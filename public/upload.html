<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ì§„ ì—…ë¡œë“œ - Rewrite Moment</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¬</text></svg>">
</head>
<body>
  <div class="bg-pattern"></div>
  <div class="noise-overlay"></div>

  <!-- Navigation -->
  <nav class="nav">
    <div class="container nav-inner">
      <a href="index.html" class="nav-logo">
        <div class="nav-logo-icon">ğŸ¬</div>
        <span class="nav-logo-text">Rewrite Moment</span>
      </a>
      <ul class="nav-links">
        <li><a href="index.html#features" class="nav-link">ê¸°ëŠ¥</a></li>
        <li><a href="index.html#how" class="nav-link">ì´ìš©ë°©ë²•</a></li>
        <li><a href="pricing.html" class="nav-link">ê°€ê²©</a></li>
      </ul>
      <div class="nav-auth">
        <div class="nav-credits">
          <span class="nav-credits-icon">ğŸ’</span>
          <span class="nav-credits-value" id="nav-credits">0</span>
          <span style="color: var(--text-muted)">í¬ë ˆë”§</span>
        </div>
        <button class="btn-login" id="btn-open-login" onclick="openAuthModal('login')">ë¡œê·¸ì¸</button>
        <div class="user-menu hidden" id="user-menu">
          <div class="user-avatar" id="user-avatar" onclick="toggleUserDropdown()">U</div>
          <div class="user-dropdown" id="user-dropdown">
            <div class="user-dropdown-header">
              <div class="user-dropdown-name" id="user-name">ì‚¬ìš©ì</div>
              <div class="user-dropdown-email" id="user-email">user@email.com</div>
            </div>
            <div class="user-dropdown-menu">
              <a href="pricing.html" class="user-dropdown-item">ğŸ’ í¬ë ˆë”§ ì¶©ì „</a>
              <a href="#" class="user-dropdown-item">ğŸ“‹ ë‚´ ì˜ìƒ</a>
              <div class="user-dropdown-item logout" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="page" style="padding-top: 100px;">
    <div class="container container-sm">
      
      <!-- Progress Steps -->
      <div class="steps">
        <div class="step active">
          <div class="step-number">1</div>
          <span class="step-text">ì—…ë¡œë“œ</span>
        </div>
        <div class="step-line"></div>
        <div class="step">
          <div class="step-number">2</div>
          <span class="step-text">ì„ íƒ</span>
        </div>
        <div class="step-line"></div>
        <div class="step">
          <div class="step-number">3</div>
          <span class="step-text">Rewrite</span>
        </div>
        <div class="step-line"></div>
        <div class="step">
          <div class="step-number">4</div>
          <span class="step-text">ê²°ê³¼</span>
        </div>
      </div>

      <!-- Page Header -->
      <div class="page-header" data-animate>
        <h1 class="page-title">
          <span class="text-gradient">ë‚´ ì‚¬ì§„</span>ìœ¼ë¡œ<br>
          ì˜í™”ë¥¼ ë§Œë“¤ì–´ë´
        </h1>
        <p class="page-subtitle">
          ì •ë©´/ë°ì€ ì‚¬ì§„ 1~3ì¥ì´ ê°€ì¥ ì˜ ë‚˜ì™€ìš”.<br>
          ë‹¤ì–‘í•œ í‘œì •ê³¼ ê°ë„ê°€ ìˆìœ¼ë©´ ë” ì¢‹ì•„ìš”.
        </p>
      </div>

      <!-- Upload Card -->
      <div class="card" data-animate style="animation-delay: 0.1s">
        <!-- Upload Zone -->
        <div class="upload-zone" id="uploadZone">
          <input type="file" id="fileInput" accept="image/jpeg,image/png,image/webp" multiple>
          <div class="upload-icon">ğŸ“¸</div>
          <h3 class="upload-title">ì‚¬ì§„ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•´ì„œ ì—…ë¡œë“œ</h3>
          <p class="upload-desc">ìµœëŒ€ 3ì¥ê¹Œì§€ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”</p>
          <p class="upload-formats">JPG, PNG, WEBP Â· ìµœëŒ€ 10MB</p>
        </div>

        <!-- Preview Grid -->
        <div class="preview-grid" id="previewGrid">
          <div class="preview-item preview-item-placeholder" data-slot="0">
            <span>+</span>
            í•„ìˆ˜
          </div>
          <div class="preview-item preview-item-placeholder" data-slot="1">
            <span>+</span>
            ì„ íƒ
          </div>
          <div class="preview-item preview-item-placeholder" data-slot="2">
            <span>+</span>
            ì„ íƒ
          </div>
        </div>

        <!-- Tips -->
        <div class="upload-tips mt-xl">
          <h4 style="font-size: 0.95rem; margin-bottom: 12px; color: var(--text-secondary);">
            ğŸ’¡ ì¢‹ì€ ì‚¬ì§„ íŒ
          </h4>
          <div class="tips-grid">
            <div class="tip-item tip-good">
              <span class="tip-icon">âœ“</span>
              <span>ì •ë©´ ì–¼êµ´ì´ ì˜ ë³´ì´ëŠ” ì‚¬ì§„</span>
            </div>
            <div class="tip-item tip-good">
              <span class="tip-icon">âœ“</span>
              <span>ë°ì€ ì¡°ëª…ì—ì„œ ì°ì€ ì‚¬ì§„</span>
            </div>
            <div class="tip-item tip-good">
              <span class="tip-icon">âœ“</span>
              <span>ë‹¤ì–‘í•œ í‘œì •/ê°ë„ í¬í•¨</span>
            </div>
            <div class="tip-item tip-bad">
              <span class="tip-icon">âœ—</span>
              <span>ì„ ê¸€ë¼ìŠ¤/ë§ˆìŠ¤í¬ ì°©ìš©</span>
            </div>
            <div class="tip-item tip-bad">
              <span class="tip-icon">âœ—</span>
              <span>ì–¼êµ´ì´ ì‘ê²Œ ë‚˜ì˜¨ ì‚¬ì§„</span>
            </div>
            <div class="tip-item tip-bad">
              <span class="tip-icon">âœ—</span>
              <span>ì‹¬í•˜ê²Œ íë¦¿í•œ ì‚¬ì§„</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Consent -->
      <div class="consent-card mt-lg" data-animate style="animation-delay: 0.2s">
        <label class="form-check">
          <input type="checkbox" class="form-check-input" id="consent1">
          <span class="form-check-label">
            ì—…ë¡œë“œí•˜ëŠ” ì‚¬ì§„ì€ ë³¸ì¸ ë˜ëŠ” ì •ë‹¹í•œ ê¶Œë¦¬ê°€ ìˆëŠ” ì‚¬ì§„ì…ë‹ˆë‹¤.
          </span>
        </label>
        <label class="form-check mt-md">
          <input type="checkbox" class="form-check-input" id="consent2">
          <span class="form-check-label">
            ê²°ê³¼ë¬¼ì€ <strong>ê°€ìƒì˜ ì°½ì‘ë¬¼(Fiction/Simulation)</strong>ì´ë©° ì˜ˆì¸¡ì´ë‚˜ ì‚¬ì‹¤ì´ ì•„ë‹˜ì„ ì´í•´í•©ë‹ˆë‹¤.
          </span>
        </label>
      </div>

      <!-- Actions -->
      <div class="actions-row mt-xl" data-animate style="animation-delay: 0.3s">
        <a href="index.html" class="btn btn-ghost">
          â† ëŒì•„ê°€ê¸°
        </a>
        <button class="btn btn-primary btn-lg" id="nextBtn" disabled>
          ë‹¤ìŒ ë‹¨ê³„ë¡œ
          <span>â†’</span>
        </button>
      </div>

      <!-- Disclaimer -->
      <div class="disclaimer mt-xl" data-animate style="animation-delay: 0.4s">
        <strong>ì•ˆë‚´:</strong> ì—…ë¡œë“œëœ ì‚¬ì§„ì€ ì˜ìƒ ìƒì„± ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©°, 
        ìƒì„± ì™„ë£Œ í›„ ì„œë²„ì—ì„œ ì‚­ì œë©ë‹ˆë‹¤. ì œ3ìì™€ ê³µìœ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
      </div>

    </div>
  </main>

  <script src="/js/app.js"></script>
  <script src="/js/videoGenerator.js"></script>
  <style>
    /* Upload Page Specific Styles */
    .page-title {
      font-size: 2.25rem;
    }

    .upload-tips {
      padding: 20px;
      background: rgba(255, 255, 255, 0.02);
      border-radius: var(--radius-md);
    }

    .tips-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .tip-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.85rem;
      color: var(--text-tertiary);
    }

    .tip-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-size: 0.7rem;
      flex-shrink: 0;
    }

    .tip-good .tip-icon {
      background: rgba(74, 222, 128, 0.15);
      color: var(--success);
    }

    .tip-bad .tip-icon {
      background: rgba(248, 113, 113, 0.15);
      color: var(--error);
    }

    .consent-card {
      padding: 20px;
      background: var(--bg-secondary);
      border: var(--border-subtle);
      border-radius: var(--radius-lg);
    }

    .consent-card strong {
      color: var(--accent-primary);
    }

    .actions-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* Preview with images */
    .preview-item.has-image {
      cursor: default;
    }

    .preview-item.has-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    @media (max-width: 768px) {
      .tips-grid {
        grid-template-columns: 1fr;
      }

      .actions-row {
        flex-direction: column;
        gap: 16px;
      }

      .actions-row .btn {
        width: 100%;
      }
    }
  </style>
  <script>
    // Upload functionality
    const uploadZone = document.getElementById('uploadZone');
    const fileInput = document.getElementById('fileInput');
    const previewGrid = document.getElementById('previewGrid');
    const nextBtn = document.getElementById('nextBtn');
    const consent1 = document.getElementById('consent1');
    const consent2 = document.getElementById('consent2');

    let uploadedFiles = [];
    const maxFiles = 3;

    // Drag and drop handlers
    uploadZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadZone.classList.add('drag-over');
    });

    uploadZone.addEventListener('dragleave', () => {
      uploadZone.classList.remove('drag-over');
    });

    uploadZone.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadZone.classList.remove('drag-over');
      handleFiles(e.dataTransfer.files);
    });

    // File input change
    fileInput.addEventListener('change', (e) => {
      handleFiles(e.target.files);
    });

    function handleFiles(files) {
      const validFiles = Array.from(files).filter(file => {
        const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
        const maxSize = 10 * 1024 * 1024; // 10MB
        return validTypes.includes(file.type) && file.size <= maxSize;
      });

      validFiles.forEach(file => {
        if (uploadedFiles.length < maxFiles) {
          uploadedFiles.push(file);
        }
      });

      updatePreviews();
      checkCanProceed();
    }

    function updatePreviews() {
      const slots = previewGrid.querySelectorAll('.preview-item');
      
      slots.forEach((slot, index) => {
        if (uploadedFiles[index]) {
          const file = uploadedFiles[index];
          const reader = new FileReader();
          
          reader.onload = (e) => {
            slot.innerHTML = `
              <img src="${e.target.result}" alt="Preview ${index + 1}">
              <button class="preview-item-remove" onclick="removeFile(${index})">Ã—</button>
            `;
            slot.classList.add('has-image');
            slot.classList.remove('preview-item-placeholder');
          };
          
          reader.readAsDataURL(file);
        } else {
          slot.innerHTML = `
            <span>+</span>
            ${index === 0 ? 'í•„ìˆ˜' : 'ì„ íƒ'}
          `;
          slot.classList.remove('has-image');
          slot.classList.add('preview-item-placeholder');
        }
      });
    }

    function removeFile(index) {
      uploadedFiles.splice(index, 1);
      updatePreviews();
      checkCanProceed();
    }

    // Make removeFile globally accessible
    window.removeFile = removeFile;

    function checkCanProceed() {
      const hasFiles = uploadedFiles.length >= 1;
      const hasConsent = consent1.checked && consent2.checked;
      nextBtn.disabled = !(hasFiles && hasConsent);
    }

    consent1.addEventListener('change', checkCanProceed);
    consent2.addEventListener('change', checkCanProceed);

    // Next button click
    nextBtn.addEventListener('click', () => {
      if (!nextBtn.disabled) {
        // In a real app, you'd save the files to session/local storage or upload them
        // For demo, we'll just navigate
        sessionStorage.setItem('uploadedCount', uploadedFiles.length);
        window.location.href = 'select.html';
      }
    });
  </script>
</body>
</html>

