<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²°ê³¼ - Rewrite Moment</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¬</text></svg>">
</head>
<body>
  <div class="bg-pattern"></div>
  <div class="noise-overlay"></div>

  <!-- Navigation -->
  <nav class="nav">
    <div class="container nav-inner">
      <a href="index.html" class="nav-logo">
        <div class="nav-logo-icon">ğŸ¬</div>
        <span class="nav-logo-text">Rewrite Moment</span>
      </a>
      <ul class="nav-links">
        <li><a href="index.html#features" class="nav-link">ê¸°ëŠ¥</a></li>
        <li><a href="index.html#how" class="nav-link">ì´ìš©ë°©ë²•</a></li>
        <li><a href="pricing.html" class="nav-link">ê°€ê²©</a></li>
      </ul>
      <div class="nav-auth">
        <div class="nav-credits">
          <span class="nav-credits-icon">ğŸ’</span>
          <span class="nav-credits-value" id="nav-credits">0</span>
          <span style="color: var(--text-muted)">í¬ë ˆë”§</span>
        </div>
        <button class="btn-login" id="btn-open-login" onclick="openAuthModal('login')">ë¡œê·¸ì¸</button>
        <div class="user-menu hidden" id="user-menu">
          <div class="user-avatar" id="user-avatar" onclick="toggleUserDropdown()">U</div>
          <div class="user-dropdown" id="user-dropdown">
            <div class="user-dropdown-header">
              <div class="user-dropdown-name" id="user-name">ì‚¬ìš©ì</div>
              <div class="user-dropdown-email" id="user-email">user@email.com</div>
            </div>
            <div class="user-dropdown-menu">
              <a href="pricing.html" class="user-dropdown-item">ğŸ’ í¬ë ˆë”§ ì¶©ì „</a>
              <a href="#" class="user-dropdown-item">ğŸ“‹ ë‚´ ì˜ìƒ</a>
              <div class="user-dropdown-item logout" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="page" style="padding-top: 100px;">
    <div class="container">
      
      <!-- Progress Steps -->
      <div class="steps">
        <div class="step completed">
          <div class="step-number">âœ“</div>
          <span class="step-text">ì—…ë¡œë“œ</span>
        </div>
        <div class="step-line completed"></div>
        <div class="step completed">
          <div class="step-number">âœ“</div>
          <span class="step-text">ì„ íƒ</span>
        </div>
        <div class="step-line completed"></div>
        <div class="step completed">
          <div class="step-number">âœ“</div>
          <span class="step-text">Rewrite</span>
        </div>
        <div class="step-line completed"></div>
        <div class="step active">
          <div class="step-number">4</div>
          <span class="step-text">ê²°ê³¼</span>
        </div>
      </div>

      <!-- Page Header -->
      <div class="page-header" data-animate>
        <h1 class="page-title">
          ğŸ‰ <span class="text-gradient">ì˜ìƒì´ ì™„ì„±</span>ë˜ì—ˆì–´ìš”!
        </h1>
        <p class="page-subtitle">
          Quick Pack Â· ì²­ì†Œë…„ Â· ì½”ë¯¸ë””
        </p>
      </div>

      <!-- Result Layout -->
      <div class="result-layout">
        
        <!-- Video Section -->
        <div class="result-video-section" data-animate style="animation-delay: 0.1s">
          <!-- Clip Tabs -->
          <div class="clip-tabs">
            <button class="clip-tab active" data-clip="1">
              <span class="clip-tab-icon">ğŸ¬</span>
              Clip 1<span class="clip-tab-role">Hook</span>
            </button>
            <button class="clip-tab" data-clip="2">
              <span class="clip-tab-icon">ğŸ¬</span>
              Clip 2<span class="clip-tab-role">Main</span>
            </button>
            <button class="clip-tab" data-clip="3">
              <span class="clip-tab-icon">âœ¨</span>
              Clip 3<span class="clip-tab-role">Ending</span>
            </button>
          </div>

          <!-- Video Player -->
          <div class="video-player-wrapper">
            <div class="video-container">
              <div class="video-placeholder" id="videoPlaceholder" style="display: none;">
                <div class="video-placeholder-icon">ğŸ¬</div>
                <p>ì˜ìƒ ë¯¸ë¦¬ë³´ê¸°</p>
                <span class="video-duration">8ì´ˆ</span>
              </div>
              <video id="videoPlayer" controls playsinline style="width: 100%; height: 100%; object-fit: cover; border-radius: var(--radius-xl);"></video>
            </div>

            <!-- Video Info -->
            <div class="video-info">
              <div class="video-caption" id="videoCaption">
                "í•˜í•„ ì˜¤ëŠ˜â€¦"
              </div>
              <div class="video-meta">
                <span>ğŸ­ ì²­ì†Œë…„</span>
                <span>ğŸ˜‚ ì½”ë¯¸ë””</span>
                <span>â±ï¸ 8ì´ˆ</span>
              </div>
            </div>
          </div>

          <!-- Video Actions -->
          <div class="video-actions">
            <button class="btn btn-secondary btn-icon" title="ì´ì „ í´ë¦½" onclick="skipTime(-2)">
              â—€
            </button>
            <button class="btn btn-primary" id="playBtn" onclick="togglePlay()">
              <span id="playIcon">â–¶</span>
              <span id="playText">ì¬ìƒí•˜ê¸°</span>
            </button>
            <button class="btn btn-secondary btn-icon" title="ë‹¤ìŒ í´ë¦½" onclick="skipTime(2)">
              â–¶
            </button>
          </div>
        </div>

        <!-- Info Section -->
        <div class="result-info-section">
          
          <!-- Download & Share -->
          <div class="card result-card" data-animate style="animation-delay: 0.2s">
            <h3 class="result-card-title">ë‹¤ìš´ë¡œë“œ & ê³µìœ </h3>
            <div class="result-card-actions">
              <button class="btn btn-primary w-full" id="downloadBtn">
                <span>â¬‡ï¸</span>
                ì „ì²´ ë‹¤ìš´ë¡œë“œ
              </button>
              <button class="btn btn-secondary w-full" id="shareBtn">
                <span>ğŸ”—</span>
                ê³µìœ  ë§í¬ ë§Œë“¤ê¸°
              </button>
            </div>
            <div class="download-options mt-md">
              <button class="btn btn-ghost btn-sm">Clip 1ë§Œ ë‹¤ìš´ë¡œë“œ</button>
              <button class="btn btn-ghost btn-sm">Clip 2ë§Œ ë‹¤ìš´ë¡œë“œ</button>
              <button class="btn btn-ghost btn-sm">Clip 3ë§Œ ë‹¤ìš´ë¡œë“œ</button>
            </div>
          </div>

          <!-- Regenerate -->
          <div class="card result-card" data-animate style="animation-delay: 0.3s" id="regenCard">
            <h3 class="result-card-title">ì¬ìƒì„±</h3>
            <p class="result-card-desc">ë§ˆìŒì— ë“¤ì§€ ì•ŠëŠ” í´ë¦½ë§Œ ë‹¤ì‹œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”</p>
            <div class="regen-options">
              <button class="btn btn-secondary btn-sm regen-btn" data-clip="1">
                <span>ğŸ”„</span> Clip 1 ë‹¤ì‹œ
              </button>
              <button class="btn btn-secondary btn-sm regen-btn" data-clip="2">
                <span>ğŸ”„</span> Clip 2 ë‹¤ì‹œ
              </button>
              <button class="btn btn-secondary btn-sm regen-btn" data-clip="3">
                <span>ğŸ”„</span> Clip 3 ë‹¤ì‹œ
              </button>
            </div>
            <div class="regen-note">
              <span>ğŸ’</span> ì¬ìƒì„±ì€ í´ë¦½ë‹¹ 1 í¬ë ˆë”§ì´ í•„ìš”í•´ìš”
            </div>
          </div>

          <!-- Upgrade Card -->
          <div class="upgrade-card" data-animate style="animation-delay: 0.4s" id="upgradeCard">
            <div class="upgrade-header">
              <span class="upgrade-badge">ğŸš€ ì—…ê·¸ë ˆì´ë“œ</span>
              <h3 class="upgrade-card-title">ë” ê¸¸ê²Œ ë§Œë“¤ê¸°</h3>
            </div>
            <p class="upgrade-card-desc">
              Story Pack(15ì´ˆÃ—3)ì€ <strong>ìƒí™©â†’ê°ì •â†’ì „í™˜</strong>ì´ ë“¤ì–´ê°€ê³ ,<br>
              TrailerëŠ” ì˜ˆê³ í¸ì²˜ëŸ¼ ì´ì–´ì§‘ë‹ˆë‹¤.
            </p>
            <div class="upgrade-options">
              <button class="btn btn-outline upgrade-btn" data-mode="story">
                <span>ğŸ“¦</span>
                Story Packìœ¼ë¡œ
                <span class="upgrade-cost">2 í¬ë ˆë”§</span>
              </button>
              <button class="btn btn-outline upgrade-btn" data-mode="trailer">
                <span>ğŸ¬</span>
                Trailerë¡œ
                <span class="upgrade-cost">5 í¬ë ˆë”§</span>
              </button>
            </div>
          </div>

          <!-- Rewrite Info (if enabled) -->
          <div class="card result-card rewrite-result-card hidden" data-animate style="animation-delay: 0.5s" id="rewriteCard">
            <div class="rewrite-result-header">
              <span>âœ¨</span>
              <h3>Rewrite Moment ì ìš©ë¨</h3>
            </div>
            <p class="rewrite-result-desc">
              Clip 3(ì—”ë”©)ì— ë‹¤ë¥¸ ê²°ë§ì´ ì ìš©ë˜ì—ˆì–´ìš”
            </p>
            <div class="rewrite-result-meta">
              <span class="rewrite-meta-item">
                <span class="meta-label">ê±°ë¦¬ë‘ê¸°:</span>
                <span class="meta-value" id="rewriteDistance">ìœ ì‚¬ ìƒí™©</span>
              </span>
              <span class="rewrite-meta-item">
                <span class="meta-label">ê²°ë§:</span>
                <span class="meta-value" id="rewriteEnding">ì„±ì¥</span>
              </span>
            </div>
            <button class="btn btn-secondary btn-sm mt-md" id="rewriteAgainBtn">
              <span>ğŸ”„</span> ì—”ë”©ë§Œ ë‹¤ì‹œ ë§Œë“¤ê¸°
            </button>
          </div>

        </div>
      </div>

      <!-- New Creation CTA -->
      <div class="new-creation-cta mt-2xl" data-animate style="animation-delay: 0.6s">
        <a href="upload.html" class="btn btn-secondary btn-lg">
          <span>âœ¨</span>
          ìƒˆë¡œìš´ ì˜ìƒ ë§Œë“¤ê¸°
        </a>
      </div>

      <!-- Disclaimer -->
      <div class="disclaimer mt-xl" data-animate style="animation-delay: 0.7s">
        <strong>Fiction / Simulation</strong> - ì´ ê²°ê³¼ë¬¼ì€ ê°€ìƒì˜ ì°½ì‘ë¬¼ì´ë©° ì˜ˆì¸¡ì´ë‚˜ ì‚¬ì‹¤ì´ ì•„ë‹™ë‹ˆë‹¤.
      </div>

    </div>
  </main>

  <!-- Share Modal -->
  <div class="modal-overlay" id="shareModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">ê³µìœ  ë§í¬</h3>
        <button class="modal-close" onclick="closeShareModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px; color: var(--text-secondary);">
          ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ê³µìœ í•˜ì„¸ìš”
        </p>
        <div class="share-link-box">
          <input type="text" class="form-input" id="shareLink" value="https://cliplife.app/s/abc123xyz" readonly>
          <button class="btn btn-primary" id="copyLinkBtn">ë³µì‚¬</button>
        </div>
        <div class="share-buttons mt-lg">
          <button class="btn btn-secondary share-social-btn">
            <span>ğŸ“±</span> ì¹´ì¹´ì˜¤í†¡
          </button>
          <button class="btn btn-secondary share-social-btn">
            <span>ğŸ¦</span> íŠ¸ìœ„í„°
          </button>
          <button class="btn btn-secondary share-social-btn">
            <span>ğŸ“·</span> ì¸ìŠ¤íƒ€
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast toast-success" id="toast">
    <span>âœ“</span>
    <span id="toastMessage">ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆì–´ìš”!</span>
  </div>

  <script src="/js/app.js"></script>
  <script src="/js/videoGenerator.js"></script>
  <style>
    /* Result Page Specific Styles */
    .result-layout {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 40px;
      align-items: start;
    }

    .result-video-section {
      position: sticky;
      top: 100px;
    }

    .clip-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }

    .clip-tab {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: var(--bg-secondary);
      border: 2px solid transparent;
      border-radius: var(--radius-full);
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .clip-tab:hover {
      background: var(--bg-tertiary);
    }

    .clip-tab.active {
      background: var(--accent-primary);
      color: #0a0a0f;
      border-color: var(--accent-primary);
    }

    .clip-tab-icon {
      font-size: 1rem;
    }

    .clip-tab-role {
      font-size: 0.75rem;
      opacity: 0.8;
      margin-left: 4px;
    }

    .video-player-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .video-container {
      width: 100%;
      max-width: 720px;
      aspect-ratio: 16/9;
      background: var(--bg-secondary);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.4),
        0 0 40px var(--accent-glow);
      border: 2px solid rgba(240, 180, 41, 0.2);
    }

    .video-placeholder {
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg, #2a1a3a 0%, #1a1025 100%);
      color: var(--text-secondary);
    }

    .video-placeholder-icon {
      font-size: 4rem;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .video-duration {
      margin-top: 8px;
      padding: 4px 12px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: var(--radius-full);
      font-size: 0.8rem;
    }

    .video-info {
      margin-top: 20px;
      text-align: center;
    }

    .video-caption {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 12px;
      color: var(--accent-tertiary);
    }

    .video-meta {
      display: flex;
      gap: 16px;
      justify-content: center;
      font-size: 0.85rem;
      color: var(--text-tertiary);
    }

    .video-actions {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 24px;
    }

    /* Result Cards */
    .result-card {
      margin-bottom: 20px;
    }

    .result-card-title {
      font-size: 1.125rem;
      margin-bottom: 12px;
    }

    .result-card-desc {
      font-size: 0.9rem;
      color: var(--text-tertiary);
      margin-bottom: 16px;
    }

    .result-card-actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .download-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .regen-options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }

    .regen-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Upgrade Card */
    .upgrade-card {
      background: linear-gradient(135deg, rgba(240, 180, 41, 0.1) 0%, rgba(240, 180, 41, 0.03) 100%);
      border: 1px solid rgba(240, 180, 41, 0.2);
      padding: 24px;
      border-radius: var(--radius-xl);
      margin-bottom: 20px;
    }

    .upgrade-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .upgrade-badge {
      padding: 4px 10px;
      background: var(--gradient-gold);
      border-radius: var(--radius-full);
      font-size: 0.75rem;
      font-weight: 700;
      color: #0a0a0f;
    }

    .upgrade-card-title {
      font-size: 1.25rem;
      margin: 0;
    }

    .upgrade-card-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .upgrade-card-desc strong {
      color: var(--accent-primary);
    }

    .upgrade-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .upgrade-btn {
      justify-content: space-between;
      padding: 16px 20px;
    }

    .upgrade-cost {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    /* Rewrite Result Card */
    .rewrite-result-card {
      background: rgba(240, 180, 41, 0.05);
      border-color: rgba(240, 180, 41, 0.2);
    }

    .rewrite-result-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .rewrite-result-header span {
      font-size: 1.25rem;
    }

    .rewrite-result-header h3 {
      font-size: 1rem;
      margin: 0;
    }

    .rewrite-result-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .rewrite-result-meta {
      display: flex;
      gap: 24px;
    }

    .rewrite-meta-item {
      font-size: 0.85rem;
    }

    .meta-label {
      color: var(--text-tertiary);
    }

    .meta-value {
      color: var(--accent-primary);
      font-weight: 600;
      margin-left: 4px;
    }

    /* Share Modal */
    .share-link-box {
      display: flex;
      gap: 12px;
    }

    .share-link-box input {
      flex: 1;
    }

    .share-buttons {
      display: flex;
      gap: 12px;
    }

    .share-social-btn {
      flex: 1;
    }

    /* New Creation CTA */
    .new-creation-cta {
      text-align: center;
    }

    @media (max-width: 1024px) {
      .result-layout {
        grid-template-columns: 1fr;
      }

      .result-video-section {
        position: static;
      }

      .result-info-section {
        order: 1;
      }
    }

    @media (max-width: 768px) {
      .clip-tabs {
        justify-content: center;
      }

      .video-container {
        max-width: 280px;
      }

      .share-buttons {
        flex-direction: column;
      }
    }
  </style>
  <script>
    // Result page functionality
    const clipTabs = document.querySelectorAll('.clip-tab');
    const videoCaption = document.getElementById('videoCaption');
    const shareModal = document.getElementById('shareModal');
    const toast = document.getElementById('toast');
    const rewriteCard = document.getElementById('rewriteCard');
    const videoPlayer = document.getElementById('videoPlayer');
    const videoPlaceholder = document.getElementById('videoPlaceholder');

    // IndexedDB í—¬í¼ í•¨ìˆ˜
    function openVideoDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open('ClipLifeVideoDB', 1);
        request.onerror = () => reject(request.error);
        request.onsuccess = () => resolve(request.result);
        request.onupgradeneeded = (event) => {
          const db = event.target.result;
          if (!db.objectStoreNames.contains('videos')) {
            db.createObjectStore('videos', { keyPath: 'id' });
          }
        };
      });
    }

    async function getVideoFromIndexedDB() {
      const db = await openVideoDB();
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['videos'], 'readonly');
        const store = transaction.objectStore('videos');
        const request = store.get('generatedVideo');
        request.onsuccess = () => resolve(request.result?.data || null);
        request.onerror = () => reject(request.error);
      });
    }

    // ìƒì„±ëœ ì˜ìƒ ë¡œë“œ
    const generationTime = sessionStorage.getItem('generationTime');
    const stage = sessionStorage.getItem('selectedStage') || 'teen';
    const genre = sessionStorage.getItem('selectedGenre') || 'comedy';

    // ìŠ¤í…Œì´ì§€/ì¥ë¥´ ë§¤í•‘
    const stageMap = { 'teen': 'ì²­ì†Œë…„', 'young_adult': 'ì²­ë…„', 'middle_adult': 'ì¤‘ë…„', 'senior': 'ì‹œë‹ˆì–´' };
    const genreMap = { 'comedy': 'ì½”ë¯¸ë””', 'drama': 'ë“œë¼ë§ˆ', 'romance': 'ë¡œë§¨ìŠ¤', 'thriller': 'ìŠ¤ë¦´ëŸ¬', 'fantasy': 'íŒíƒ€ì§€' };

    // í˜ì´ì§€ ì„œë¸Œíƒ€ì´í‹€ ì—…ë°ì´íŠ¸
    const pageSubtitle = document.querySelector('.page-subtitle');
    if (pageSubtitle) {
      pageSubtitle.textContent = `Quick Pack Â· ${stageMap[stage] || stage} Â· ${genreMap[genre] || genre}`;
    }

    // ì˜ìƒ ë¡œë“œ (IndexedDBì—ì„œ)
    async function loadVideo() {
      try {
        const generatedVideo = await getVideoFromIndexedDB();
        
        if (generatedVideo) {
          videoPlayer.src = generatedVideo;
          videoPlayer.style.display = 'block';
          videoPlaceholder.style.display = 'none';
          
          // ìƒì„± ì‹œê°„ í‘œì‹œ
          if (generationTime) {
            console.log(`ì˜ìƒ ìƒì„± ì‹œê°„: ${parseFloat(generationTime).toFixed(1)}ì´ˆ`);
          }
        } else {
          // ì˜ìƒì´ ì—†ìœ¼ë©´ í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ
          videoPlayer.style.display = 'none';
          videoPlaceholder.style.display = 'flex';
        }
      } catch (error) {
        console.error('ì˜ìƒ ë¡œë“œ ì˜¤ë¥˜:', error);
        videoPlayer.style.display = 'none';
        videoPlaceholder.style.display = 'flex';
      }
    }
    
    loadVideo();

    // Clip captions (sample data)
    const clipData = {
      1: { caption: '"í•˜í•„ ì˜¤ëŠ˜â€¦"', duration: '4ì´ˆ', role: 'Hook' },
      2: { caption: '"ë‚´ê°€ ì™œ ê·¸ë¬ì§€"', duration: '4ì´ˆ', role: 'Main' },
      3: { caption: '"ê·¼ë°â€¦ ì˜ì™¸ë¡œ"', duration: '4ì´ˆ', role: 'Ending' }
    };

    // Clip tab switching
    clipTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        clipTabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        const clipNo = tab.dataset.clip;
        const data = clipData[clipNo];
        videoCaption.textContent = data.caption;
      });
    });

    // Check if rewrite was enabled
    const rewriteEnabled = sessionStorage.getItem('rewriteEnabled') === 'true';
    if (rewriteEnabled) {
      rewriteCard.classList.remove('hidden');
      
      // Update rewrite meta
      const distance = sessionStorage.getItem('distance');
      const ending = sessionStorage.getItem('ending');
      
      const distanceMap = {
        'symbolic': 'ìƒì§•ì ìœ¼ë¡œ',
        'similar': 'ìœ ì‚¬ ìƒí™©',
        'quite_similar': 'ê½¤ ë¹„ìŠ·í•˜ê²Œ'
      };
      
      const endingMap = {
        'recovery': 'íšŒë³µ',
        'growth': 'ì„±ì¥',
        'reconcile': 'í™”í•´',
        'self_protect': 'ìê¸°ë³´í˜¸',
        'new_start': 'ìƒˆì¶œë°œ',
        'comedy': 'ì½”ë¯¸ë”” ìŠ¹í™”'
      };
      
      document.getElementById('rewriteDistance').textContent = distanceMap[distance] || 'ìœ ì‚¬ ìƒí™©';
      document.getElementById('rewriteEnding').textContent = endingMap[ending] || 'ì„±ì¥';
    }

    // Share modal
    document.getElementById('shareBtn').addEventListener('click', () => {
      shareModal.classList.add('show');
    });

    function closeShareModal() {
      shareModal.classList.remove('show');
    }

    shareModal.addEventListener('click', (e) => {
      if (e.target === shareModal) {
        closeShareModal();
      }
    });

    // Copy link
    document.getElementById('copyLinkBtn').addEventListener('click', () => {
      const input = document.getElementById('shareLink');
      input.select();
      document.execCommand('copy');
      
      showToast('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆì–´ìš”!');
    });

    // Toast notification
    function showToast(message) {
      const toastMessage = document.getElementById('toastMessage');
      toastMessage.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Video control functions
    function togglePlay() {
      const playIcon = document.getElementById('playIcon');
      const playText = document.getElementById('playText');
      
      if (videoPlayer.paused) {
        videoPlayer.play();
        playIcon.textContent = 'â¸';
        playText.textContent = 'ì¼ì‹œì •ì§€';
      } else {
        videoPlayer.pause();
        playIcon.textContent = 'â–¶';
        playText.textContent = 'ì¬ìƒí•˜ê¸°';
      }
    }

    function skipTime(seconds) {
      videoPlayer.currentTime += seconds;
    }

    // Update play button when video ends
    videoPlayer.addEventListener('ended', () => {
      document.getElementById('playIcon').textContent = 'â–¶';
      document.getElementById('playText').textContent = 'ì¬ìƒí•˜ê¸°';
    });

    // Download button
    document.getElementById('downloadBtn').addEventListener('click', () => {
      if (generatedVideo) {
        // ì˜ìƒ ë‹¤ìš´ë¡œë“œ
        const a = document.createElement('a');
        a.href = generatedVideo;
        a.download = `rewrite_moment_${Date.now()}.mp4`;
        a.target = '_blank';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        showToast('ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤...');
      } else {
        showToast('ë‹¤ìš´ë¡œë“œí•  ì˜ìƒì´ ì—†ìŠµë‹ˆë‹¤');
      }
    });

    // Upgrade buttons
    document.querySelectorAll('.upgrade-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const mode = btn.dataset.mode;
        const cost = mode === 'story' ? 2 : 5;
        
        // In production, this would check credits and process the upgrade
        alert(`${mode === 'story' ? 'Story Pack' : 'Trailer'}ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ë ¤ë©´ ${cost} í¬ë ˆë”§ì´ í•„ìš”í•´ìš”.\n\ní¬ë ˆë”§ ì¶©ì „ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.`);
        window.location.href = 'pricing.html';
      });
    });

    // Regenerate buttons
    document.querySelectorAll('.regen-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const clipNo = btn.dataset.clip;
        
        // In production, this would check credits and process regeneration
        alert(`Clip ${clipNo} ì¬ìƒì„±ì— 1 í¬ë ˆë”§ì´ í•„ìš”í•´ìš”.\n\ní¬ë ˆë”§ì„ ì¶©ì „í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
      });
    });

    // Rewrite again button
    if (document.getElementById('rewriteAgainBtn')) {
      document.getElementById('rewriteAgainBtn').addEventListener('click', () => {
        alert('ì—”ë”© ì¬ìƒì„±ì— 1 í¬ë ˆë”§ì´ í•„ìš”í•´ìš”.\n\ní¬ë ˆë”§ì„ ì¶©ì „í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
      });
    }
  </script>
</body>
</html>

